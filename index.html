<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.10.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>co_ecs: co_ecs</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="clipboard.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
  </script>
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
  </script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeInteractiveToc.init()
  </script>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectalign">
                <div id="projectname">co_ecs<span
                    id="projectnumber">&#160;0.9.0</span>
                </div>
                <div id="projectbrief">Cobalt ECS</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part --><!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="namespaceco__ecs.html">co_ecs</a> </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a></p>
<h1><a class="anchor" id="autotoc_md0"></a>
co_ecs</h1>
<p><img src="https://github.com/Blyschak/co_ecs/blob/assets/logo.png?raw=true" alt="logo" width="15%" class="inline"/></p>
<p><img src="https://img.shields.io/badge/STD-C++20-blue" alt="C++" class="inline"/> <a href="https://blyschak.github.io/co_ecs/"><img src="https://img.shields.io/badge/Documentation-Doxygen-blue" alt="Doxygen" class="inline"/></a> <a href="http://unlicense.org/"><img src="https://img.shields.io/badge/License-MIT-blue.svg" alt="License: MIT" style="pointer-events: none;" class="inline"/></a> <img src="https://github.com/Blyschak/co_ecs/actions/workflows/build.yml/badge.svg" alt="Build badge" style="pointer-events: none;" class="inline"/> <a href="https://codecov.io/gh/Blyschak/cobalt-ecs"><img src="https://codecov.io/gh/Blyschak/co_ecs/branch/main/graph/badge.svg?token=BZ8Z6TXN55" alt="codecov" style="pointer-events: none;" class="inline"/></a> <img src="https://raw.githubusercontent.com/Blyschak/co_ecs/badges/badge.svg" alt="LoC" style="pointer-events: none;" class="inline"/></p>
<p><a class="el" href="namespaceco__ecs.html">co_ecs</a> is a header-only library implementing an Entity Component System.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
API Documentation</h2>
<p><a href="https://blyschak.github.io/co_ecs/">Doxygen</a></p>
<h2><a class="anchor" id="autotoc_md2"></a>
Table of Contents</h2>
<ul>
<li>Build<ul>
<li>Build and run tests</li>
<li>Build and run benchmarks</li>
<li>Build documentation</li>
<li>Build examples</li>
</ul>
</li>
<li>Usage<ul>
<li>System wide installation</li>
<li>CMake Integration</li>
<li>Code example</li>
</ul>
</li>
<li>Components</li>
<li>Views</li>
<li>Safety</li>
<li>Pitfalls</li>
<li>Usage Across Binary Boundaries</li>
<li>License</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
Build</h2>
<p>Compilation requires compiler with C++ 20 support.</p>
<p>Tested compilers:</p><ul>
<li>GCC 11.2</li>
<li>Clang 16</li>
<li>MSVC 14.32</li>
</ul>
<p>Before building targets create a <code>build/</code> directory in the root of the source tree and <code>cd</code> into it:</p>
<div class="fragment"><div class="line">mkdir build/ &amp;&amp; cd build/</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md4"></a>
Build and run tests</h3>
<div class="fragment"><div class="line">cmake .. -DCO_ECS_ENABLE_TESTING=ON</div>
<div class="line">make -j$(nproc)</div>
<div class="line">make test</div>
</div><!-- fragment --><p>Generate coverage report:</p>
<div class="fragment"><div class="line">cmake .. -DCO_ECS_ENABLE_TESTING=ON -DCO_ECS_CODE_COVERAGE=ON</div>
<div class="line">make -j$(nproc)</div>
<div class="line">make test</div>
</div><!-- fragment --><p>Coverage reports might be misleading when building in release mode, so make sure you build in debug mode or explicitly pass <code>-DCMAKE_BUILD_TYPE=Debug</code>.</p>
<h3><a class="anchor" id="autotoc_md5"></a>
Build and run benchmarks</h3>
<div class="fragment"><div class="line"># Build with optimizations</div>
<div class="line">cmake .. -DCO_ECS_ENABLE_BENCHMARKS=ON -DCMAKE_BUILD_TYPE=Release</div>
<div class="line">make -j$(nproc)</div>
<div class="line">benchmarks/benchmarks</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md6"></a>
Build documentation</h3>
<div class="fragment"><div class="line">cmake .. -DCO_ECS_ENABLE_DOCS=ON</div>
<div class="line">make docs</div>
<div class="line"># documentation generated: docs/html/index.html</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md7"></a>
Build examples</h3>
<div class="fragment"><div class="line">cmake .. -DCO_ECS_ENABLE_EXAMPLES=ON</div>
<div class="line">make -j$(nproc)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md8"></a>
Usage</h2>
<h3><a class="anchor" id="autotoc_md9"></a>
System wide installation</h3>
<p>Inside your build directory execute the following to install <code><a class="el" href="namespaceco__ecs.html">co_ecs</a></code>:</p>
<div class="fragment"><div class="line">make install</div>
</div><!-- fragment --><p>This <code>make</code> target will install <code><a class="el" href="namespaceco__ecs.html">co_ecs</a></code> headers into your system include directory.</p>
<h3><a class="anchor" id="autotoc_md10"></a>
CMake Integration</h3>
<p>Using <code>FetchConent</code>:</p>
<div class="fragment"><div class="line">include(FetchContent)</div>
<div class="line"> </div>
<div class="line">FetchContent_Declare(</div>
<div class="line">  co_ecs</div>
<div class="line">  GIT_REPOSITORY https://github.com/Blyschak/co_ecs</div>
<div class="line">  GIT_TAG main)</div>
<div class="line">FetchContent_MakeAvailable(co_ecs)</div>
<div class="line"> </div>
<div class="line"># link to your executable</div>
<div class="line">target_link_libraries(my-engine co_ecs)</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md11"></a>
Code example</h3>
<p><a href="examples/hello-registry/main.cpp">Example</a></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="co__ecs_8hpp.html">co_ecs/co_ecs.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>position {</div>
<div class="line">    <span class="keywordtype">float</span> x, y;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>velocity {</div>
<div class="line">    <span class="keywordtype">float</span> x, y;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> print_positions(<span class="keyword">const</span> <a class="code hl_class" href="classco__ecs_1_1registry.html">co_ecs::registry</a>&amp; registry) {</div>
<div class="line">    registry.<a class="code hl_function" href="classco__ecs_1_1registry.html#addc9d543fae80972cdff4791b5746bf6">each</a>(</div>
<div class="line">        [](<span class="keyword">const</span> position&amp; position) { std::cout &lt;&lt; <span class="stringliteral">&quot;position {&quot;</span> &lt;&lt; position.x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; position.y &lt;&lt; <span class="stringliteral">&quot;}\n&quot;</span>; });</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <a class="code hl_class" href="classco__ecs_1_1registry.html">co_ecs::registry</a> registry;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 100; i++) {</div>
<div class="line">        registry.<a class="code hl_function" href="classco__ecs_1_1registry.html#a5b71eb4c1946420116d524d19a66aa17">create</a>&lt;position, velocity&gt;({ i * 1.f, i * 1.5f }, { i * .3f, -i * 5.f });</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> [position, velocity] : registry.view&lt;position&amp;, const velocity&amp;&gt;().each()) {</div>
<div class="line">        position.x += velocity.x;</div>
<div class="line">        position.y += velocity.y;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    print_positions(registry);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassco__ecs_1_1registry_html"><div class="ttname"><a href="classco__ecs_1_1registry.html">co_ecs::registry</a></div><div class="ttdoc">Registry is a container for all our entities and components. Components are stored in continuously in...</div><div class="ttdef"><b>Definition</b> registry.hpp:13</div></div>
<div class="ttc" id="aclassco__ecs_1_1registry_html_a5b71eb4c1946420116d524d19a66aa17"><div class="ttname"><a href="classco__ecs_1_1registry.html#a5b71eb4c1946420116d524d19a66aa17">co_ecs::registry::create</a></div><div class="ttdeci">constexpr auto create(Components &amp;&amp;... args) -&gt; entity_ref</div><div class="ttdoc">Creates a new entity and attaches the specified components to it.</div><div class="ttdef"><b>Definition</b> registry.hpp:39</div></div>
<div class="ttc" id="aclassco__ecs_1_1registry_html_addc9d543fae80972cdff4791b5746bf6"><div class="ttname"><a href="classco__ecs_1_1registry.html#addc9d543fae80972cdff4791b5746bf6">co_ecs::registry::each</a></div><div class="ttdeci">constexpr void each(F &amp;&amp;func)</div><div class="ttdoc">Executes a given function on each entity that matches the specified component requirements.</div><div class="ttdef"><b>Definition</b> registry.hpp:147</div></div>
<div class="ttc" id="aco__ecs_8hpp_html"><div class="ttname"><a href="co__ecs_8hpp.html">co_ecs.hpp</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md12"></a>
Components</h2>
<p>Component is any C++ type that satisfies the following:</p><ul>
<li>It is a non-union class type, meaning any <code>struct</code> or <code>class</code></li>
<li>It is <code>noexcept</code> move constructible</li>
<li>It is <code>noexcept</code> move assignable</li>
</ul>
<h2><a class="anchor" id="autotoc_md13"></a>
Views</h2>
<p>Views are used to iterate over entities in the registry with a specified set of components attached:</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keyword">auto</span> [position, velocity] : registry.view&lt;position&amp;, const velocity&amp;&gt;().each()) {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>You don't need to worry about caching a view object returned by <code>registry::view()</code> because it is very inexpensive to create. The actual work of matching archetypes is done only when you start iterating over it using <code>view::each()</code>.</p>
<p>Another way to iterate over relevant entities is by using <code>registry::each()</code>, which takes an invocable as a parameter that accepts component reference types:</p>
<div class="fragment"><div class="line">registry.<a class="code hl_function" href="classco__ecs_1_1registry.html#addc9d543fae80972cdff4791b5746bf6">each</a>([](position&amp; pos, <span class="keyword">const</span> velocity&amp; vel){</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">});</div>
</div><!-- fragment --><p><code><a class="el" href="namespaceco__ecs.html">co_ecs</a></code> aims to provide a const-correct API. For example, a view with <code>const</code> references can only be created from a <code>const</code> registry reference:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> foo(<span class="keyword">const</span> <a class="code hl_class" href="classco__ecs_1_1registry.html">co_ecs::registry</a>&amp; registry) {</div>
<div class="line">    registry.<a class="code hl_function" href="classco__ecs_1_1registry.html#ae75a55d6387d569f63fe28a1c0ca46b9">view</a>&lt;<span class="keyword">const</span> position&amp;, <span class="keyword">const</span> velocity&amp;&gt;(); <span class="comment">// OK</span></div>
<div class="line">    registry.<a class="code hl_function" href="classco__ecs_1_1registry.html#ae75a55d6387d569f63fe28a1c0ca46b9">view</a>&lt;position&amp;, <span class="keyword">const</span> velocity&amp;&gt;();       <span class="comment">// Error</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassco__ecs_1_1registry_html_ae75a55d6387d569f63fe28a1c0ca46b9"><div class="ttname"><a href="classco__ecs_1_1registry.html#ae75a55d6387d569f63fe28a1c0ca46b9">co_ecs::registry::view</a></div><div class="ttdeci">constexpr auto view() -&gt; co_ecs::view&lt; Args... &gt; requires(!const_component_references_v&lt; Args... &gt;)</div><div class="ttdoc">Create a non-const view based on component query in parameter pack.</div><div class="ttdef"><b>Definition</b> registry.hpp:85</div></div>
</div><!-- fragment --><p>Views are used to iterate over entities in the registry with a specified set of components attached:</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keyword">auto</span> [position, velocity] : registry.view&lt;position&amp;, const velocity&amp;&gt;().each()) {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>You don't need to worry about caching a view object returned by <code>registry::view()</code> because it is very inexpensive to create. The actual work of matching archetypes is done only when you start iterating over it using <code>view::each()</code>.</p>
<p>Another way to iterate over relevant entities is by using <code>registry::each()</code>, which takes an invocable as a parameter that accepts component reference types:</p>
<div class="fragment"><div class="line">registry.<a class="code hl_function" href="classco__ecs_1_1registry.html#addc9d543fae80972cdff4791b5746bf6">each</a>([](position&amp; pos, <span class="keyword">const</span> velocity&amp; vel){</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">});</div>
</div><!-- fragment --><p>This kind of iteration might be even faster and better optimized by the compiler. The function can operate on a chunk that yields two tuples of pointers to the actual data, whereas the <code>each()</code> variant returns an iterator over iterators to the actual data, which is more challenging for the compiler to optimize. Refer to the benchmarks to see the actual performance difference. We look forward to compilers improving their optimization of <code>&lt;ranges&gt;</code> machinery to make the performance of these two variants match.</p>
<p><code><a class="el" href="namespaceco__ecs.html">co_ecs</a></code> aims to provide a const-correct API. For example, a view with <code>const</code> references can only be created from a <code>const</code> registry reference:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> foo(<span class="keyword">const</span> <a class="code hl_class" href="classco__ecs_1_1registry.html">co_ecs::registry</a>&amp; registry) {</div>
<div class="line">    registry.<a class="code hl_function" href="classco__ecs_1_1registry.html#ae75a55d6387d569f63fe28a1c0ca46b9">view</a>&lt;<span class="keyword">const</span> position&amp;, <span class="keyword">const</span> velocity&amp;&gt;(); <span class="comment">// OK</span></div>
<div class="line">    registry.<a class="code hl_function" href="classco__ecs_1_1registry.html#ae75a55d6387d569f63fe28a1c0ca46b9">view</a>&lt;position&amp;, <span class="keyword">const</span> velocity&amp;&gt;();       <span class="comment">// Error</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md14"></a>
Safety</h2>
<p><code><a class="el" href="namespaceco__ecs.html">co_ecs</a></code> aims to provide a safe API. For example, creating an entity and specifying the same component type more than once is ambiguous and causes undefined behavior. The following snippet will fail to compile:</p>
<div class="fragment"><div class="line">registry.<a class="code hl_function" href="classco__ecs_1_1registry.html#a5b71eb4c1946420116d524d19a66aa17">create</a>&lt;position, position&gt;({ 1, 2 }, { 3, 4 });</div>
</div><!-- fragment --><p>The compiler will generate a static assertion error:</p>
<div class="fragment"><div class="line">Types must be unique within parameter pack</div>
</div><!-- fragment --><p>Another example is when mistakenly trying to assign a component of type <code><a class="el" href="namespaceco__ecs.html#acb6f48f6f56ae34f433899ff614ca321" title="Represents an entity, consisting of an ID and generation.">co_ecs::entity</a></code>. The <code><a class="el" href="namespaceco__ecs.html#acb6f48f6f56ae34f433899ff614ca321" title="Represents an entity, consisting of an ID and generation.">co_ecs::entity</a></code> structure is handled internally in the same way as components, but it is invalid to assign it as a component to an entity. When attempting the following:</p>
<div class="fragment"><div class="line">registry.<a class="code hl_function" href="classco__ecs_1_1registry.html#a5b71eb4c1946420116d524d19a66aa17">create</a>&lt;<a class="code hl_typedef" href="namespaceco__ecs.html#acb6f48f6f56ae34f433899ff614ca321">co_ecs::entity</a>, position&gt;({}, { 3, 4 });</div>
<div class="ttc" id="anamespaceco__ecs_html_acb6f48f6f56ae34f433899ff614ca321"><div class="ttname"><a href="namespaceco__ecs.html#acb6f48f6f56ae34f433899ff614ca321">co_ecs::entity</a></div><div class="ttdeci">detail::handle&lt; struct entity_tag_t &gt; entity</div><div class="ttdoc">Represents an entity, consisting of an ID and generation.</div><div class="ttdef"><b>Definition</b> entity.hpp:13</div></div>
</div><!-- fragment --><p>The compiler will raise the following static assertion error:</p>
<div class="fragment"><div class="line">Cannot give a mutable pointer/reference to the entity</div>
</div><!-- fragment --><p>This implies that you cannot have write access to the memory chunk where <code><a class="el" href="namespaceco__ecs.html#acb6f48f6f56ae34f433899ff614ca321" title="Represents an entity, consisting of an ID and generation.">co_ecs::entity</a></code> objects are stored.</p>
<p>The same error message appears when trying to create a <code><a class="el" href="classco__ecs_1_1view.html" title="A view lets you get a range over components of Args out of a registry.">co_ecs::view</a></code> with read-write access to <code><a class="el" href="namespaceco__ecs.html#acb6f48f6f56ae34f433899ff614ca321" title="Represents an entity, consisting of an ID and generation.">co_ecs::entity</a></code>:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> view = registry.<a class="code hl_function" href="classco__ecs_1_1registry.html#ae75a55d6387d569f63fe28a1c0ca46b9">view</a>&lt;<a class="code hl_typedef" href="namespaceco__ecs.html#acb6f48f6f56ae34f433899ff614ca321">co_ecs::entity</a>&amp;, position&amp;&gt;(); <span class="comment">// Error</span></div>
</div><!-- fragment --><p>However, querying for <code>const <a class="el" href="namespaceco__ecs.html#acb6f48f6f56ae34f433899ff614ca321" title="Represents an entity, consisting of an ID and generation.">co_ecs::entity</a>&amp;</code> is valid and the correct method to fetch entity IDs together with their components in the view:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> view = registry.<a class="code hl_function" href="classco__ecs_1_1registry.html#ae75a55d6387d569f63fe28a1c0ca46b9">view</a>&lt;<span class="keyword">const</span> <a class="code hl_typedef" href="namespaceco__ecs.html#acb6f48f6f56ae34f433899ff614ca321">co_ecs::entity</a>&amp;, position&amp;&gt;(); <span class="comment">// OK</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md15"></a>
Pitfalls</h2>
<p>Components are referenced internally by IDs. The component ID is generated statically, and the resulting ID is compiler implementation-defined. There should be no logic that relies on a specific ID value. Due to how ID generation works, there is a limitation that restricts placing components inside implementation files (<code>*.cpp</code>) or private headers.</p>
<p>Consider the following two components with the same name defined in two separate compilation units in the global namespace:</p>
<p><em>foo.cpp</em>:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>my_component {</div>
<div class="line">    <span class="keywordtype">int</span> value;</div>
<div class="line">};</div>
</div><!-- fragment --><p><em>bar.cpp</em>:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>my_component {</div>
<div class="line">    <span class="keywordtype">void</span>* data;</div>
<div class="line">};</div>
</div><!-- fragment --><p>There is a high chance the compiler will generate the same ID for these two different structures, leading to undefined behavior. Therefore, it is recommended to place all components in public header files, or even in a single header file, to avoid name collisions.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
Usage Across Binary Boundaries</h2>
<p><code><a class="el" href="namespaceco__ecs.html">co_ecs</a></code> can be used across binary boundaries. For example, you can create an engine shared library with core components and then use the registry inside another shared library or executable that links to the engine. The core shared library should be compiled with <code>CO_ECS_HOST</code> defined, and the others must define <code>CO_ECS_CLIENT</code>.</p>
<p><em>engine.h</em>: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="co__ecs_8hpp.html">co_ecs/co_ecs.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>transform {</div>
<div class="line">    <span class="keywordtype">float</span> translation[3];</div>
<div class="line">    <span class="keywordtype">float</span> rotation[3];</div>
<div class="line">    <span class="keywordtype">float</span> scale[3];</div>
<div class="line">};</div>
</div><!-- fragment --><p><em>engine.cpp</em>: </p><div class="fragment"><div class="line"><span class="preprocessor">#define CO_ECS_HOST</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;engine.h&quot;</span></div>
</div><!-- fragment --><p><em>client.cpp</em>: </p><div class="fragment"><div class="line"><span class="preprocessor">#define CO_ECS_CLIENT</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;engine.h&quot;</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md17"></a>
License</h2>
<p><a class="el" href="namespaceco__ecs.html">co_ecs</a> is distributed under the MIT license. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
